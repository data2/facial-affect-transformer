开始进入训练===================
✅ 使用GPU: NVIDIA GeForce RTX 3090
💾 显存: 23.6 GB
使用模型: ViT-Base







使用batch_size: 16
📊 数据加载器配置:
  训练样本: 28709
  验证样本: 7178
  数据加载进程: 4
类别权重: [1.0266047  9.406619   1.0010461  0.56843877 0.82603943 0.8491275
 1.293373  ]
🔄 从本地加载预训练权重: ./weights/vit_base_patch16_224.pth
✅ 权重文件加载成功，文件大小: 0.32 GB
🔍 权重文件包含的键数量: 152
⚠️ 跳过分类头权重: head.weight
⚠️ 跳过分类头权重: head.bias
🔍 过滤后保留的键数量: 150
✅ 本地预训练权重加载成功！
📊 权重加载报告:
  缺失的键: 2个
    主要缺失分类头权重，这是正常的
  意外的键: 0个
🎯 预训练参数比例: 100.0%
🎉 预训练权重加载非常成功！
✅ 模型创建成功，已移动到 cuda
🎯 使用学习率: 2e-05

🚀 开始训练循环（使用本地预训练权重）
============================================================

📊 Epoch [1/50]
训练中:  89%|████████████████████████████████████████████████████████████████████████████████▏         | 1599/1795 [03:23<00:24,  7.87it/s, loss=1.29]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:47<00:00,  7.87it/s, loss=0.463]
📈 训练损失: 1.2824
🎯 验证准确率: 62.94%, 验证损失: 1.0103                                                                                                               
🎉 新的最佳准确率: 62.94% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 247.2秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [2/50]
训练中:  33%|█████████████████████████████▊                                                             | 589/1795 [01:15<02:33,  7.85it/s, loss=1.19]训练中:  33%|█████████████████████████████▉                                                             | 590/1795 [01:15<02:33,  7.86it/s, loss=1.37]训练中:  33%|██████████████████████████████▎                                                            | 599/1795 [01:16<02:32,  7.85it/s, loss=1.18]训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.84it/s, loss=0.714]
📈 训练损失: 1.0252
🎯 验证准确率: 65.91%, 验证损失: 0.9198                                                                                                               
🎉 新的最佳准确率: 65.91% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 248.9秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [3/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:56<00:00,  7.58it/s, loss=0.313]
📈 训练损失: 0.9157
🎯 验证准确率: 68.35%, 验证损失: 0.8629                                                                                                               
🎉 新的最佳准确率: 68.35% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 256.7秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [4/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:54<00:00,  7.66it/s, loss=0.323]
📈 训练损失: 0.8197
🎯 验证准确率: 68.14%, 验证损失: 0.9035                                                                                                               
⏱️  本轮耗时: 253.0秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 1/8
------------------------------------------------------------

📊 Epoch [5/50]
训练中: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.83it/s, loss=1.72]
📈 训练损失: 0.7390
🎯 验证准确率: 70.33%, 验证损失: 0.8525                                                                                                               
🎉 新的最佳准确率: 70.33% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 249.2秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [6/50]
训练中: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:56<00:00,  7.59it/s, loss=1.47]
📈 训练损失: 0.6574
🎯 验证准确率: 70.94%, 验证损失: 0.8533                                                                                                               
🎉 新的最佳准确率: 70.94% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 256.5秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [7/50]
训练中: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.75]
📈 训练损失: 0.5738
🎯 验证准确率: 70.56%, 验证损失: 0.8689                                                                                                               
⏱️  本轮耗时: 248.2秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 1/8
------------------------------------------------------------

📊 Epoch [8/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.171]
📈 训练损失: 0.5094
🎯 验证准确率: 70.33%, 验证损失: 0.9904                                                                                                               
⏱️  本轮耗时: 248.2秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 2/8
------------------------------------------------------------

📊 Epoch [9/50]
训练中: 100%|████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.0577]
📈 训练损失: 0.4512
🎯 验证准确率: 70.33%, 验证损失: 1.0774                                                                                                               
⏱️  本轮耗时: 248.2秒
📈 当前学习率: 2.00e-05
⏰ 早停计数器: 3/8
------------------------------------------------------------

📊 Epoch [10/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:57<00:00,  7.56it/s, loss=0.106]
📈 训练损失: 0.4085
🎯 验证准确率: 69.95%, 验证损失: 1.1870                                                                                                               
📉 学习率从 2.00e-05 降低到 1.00e-05
⏱️  本轮耗时: 256.1秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 4/8
------------------------------------------------------------

📊 Epoch [11/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:58<00:00,  7.52it/s, loss=0.385]
📈 训练损失: 0.2744
🎯 验证准确率: 71.09%, 验证损失: 1.3409                                                                                                               
🎉 新的最佳准确率: 71.09% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 258.6秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 5/8
------------------------------------------------------------

📊 Epoch [12/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.448]
📈 训练损失: 0.2260
🎯 验证准确率: 71.40%, 验证损失: 1.5912                                                                                                               
🎉 新的最佳准确率: 71.40% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 249.6秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [13/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.822]
📈 训练损失: 0.2121
🎯 验证准确率: 71.38%, 验证损失: 1.5533                                                                                                               
⏱️  本轮耗时: 248.2秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 1/8
------------------------------------------------------------

📊 Epoch [14/50]
训练中: 100%|███████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:56<00:00,  7.58it/s, loss=0.00695]
📈 训练损失: 0.2008
🎯 验证准确率: 71.65%, 验证损失: 1.7538                                                                                                               
🎉 新的最佳准确率: 71.65% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 256.7秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [15/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.234]
📈 训练损失: 0.1814
🎯 验证准确率: 71.65%, 验证损失: 1.9670                                                                                                               
⏱️  本轮耗时: 248.3秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 1/8
------------------------------------------------------------

📊 Epoch [16/50]
训练中: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.47]
📈 训练损失: 0.1740
🎯 验证准确率: 70.77%, 验证损失: 2.0397                                                                                                               
⏱️  本轮耗时: 248.2秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 2/8
------------------------------------------------------------

📊 Epoch [17/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:53<00:00,  7.69it/s, loss=0.261]
📈 训练损失: 0.1702
🎯 验证准确率: 71.89%, 验证损失: 2.1578                                                                                                               
🎉 新的最佳准确率: 71.89% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 253.2秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [18/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:57<00:00,  7.57it/s, loss=0.473]
📈 训练损失: 0.1670
🎯 验证准确率: 70.90%, 验证损失: 2.2122                                                                                                               
⏱️  本轮耗时: 257.2秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 1/8
------------------------------------------------------------

📊 Epoch [19/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [04:10<00:00,  7.16it/s, loss=0.402]
📈 训练损失: 0.1579
🎯 验证准确率: 71.59%, 验证损失: 2.1228                                                                                                               
⏱️  本轮耗时: 269.5秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 2/8
------------------------------------------------------------

📊 Epoch [20/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.81it/s, loss=0.224]
📈 训练损失: 0.1556
🎯 验证准确率: 72.26%, 验证损失: 2.3377                                                                                                               
🎉 新的最佳准确率: 72.26% -> best_vit_base_local_pretrained.pth
⏱️  本轮耗时: 249.7秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 0/8
------------------------------------------------------------

📊 Epoch [21/50]
训练中: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.000777]
📈 训练损失: 0.1484
🎯 验证准确率: 71.72%, 验证损失: 2.4317                                                                                                               
⏱️  本轮耗时: 248.3秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 1/8
------------------------------------------------------------

📊 Epoch [22/50]
训练中: 100%|████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:55<00:00,  7.62it/s, loss=4.4e-5]
📈 训练损失: 0.1520
🎯 验证准确率: 71.69%, 验证损失: 2.5243                                                                                                               
⏱️  本轮耗时: 254.1秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 2/8
------------------------------------------------------------

📊 Epoch [23/50]
训练中: 100%|█████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.396]
📈 训练损失: 0.1409
🎯 验证准确率: 71.37%, 验证损失: 2.3387                                                                                                               
⏱️  本轮耗时: 248.3秒
📈 当前学习率: 1.00e-05
⏰ 早停计数器: 3/8
------------------------------------------------------------

📊 Epoch [24/50]
训练中: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:56<00:00,  7.61it/s, loss=0.000563]
📈 训练损失: 0.1434
🎯 验证准确率: 71.05%, 验证损失: 2.4003                                                                                                               
📉 学习率从 1.00e-05 降低到 5.00e-06
⏱️  本轮耗时: 254.8秒
📈 当前学习率: 5.00e-06
⏰ 早停计数器: 4/8
------------------------------------------------------------

📊 Epoch [25/50]
训练中: 100%|███████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=4.81e-8]
📈 训练损失: 0.1104
🎯 验证准确率: 72.15%, 验证损失: 2.6469                                                                                                               
⏱️  本轮耗时: 248.2秒
📈 当前学习率: 5.00e-06
⏰ 早停计数器: 5/8
------------------------------------------------------------

📊 Epoch [26/50]
训练中: 100%|██████████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=0.11]
📈 训练损失: 0.0888
🎯 验证准确率: 71.82%, 验证损失: 2.6604                                                                                                               
⏱️  本轮耗时: 248.2秒
📈 当前学习率: 5.00e-06
⏰ 早停计数器: 6/8
------------------------------------------------------------

📊 Epoch [27/50]
训练中: 100%|███████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=3.77e-6]
📈 训练损失: 0.1012
🎯 验证准确率: 71.76%, 验证损失: 2.6336                                                                                                               
⏱️  本轮耗时: 248.3秒
📈 当前学习率: 5.00e-06
⏰ 早停计数器: 7/8
------------------------------------------------------------

📊 Epoch [28/50]
训练中: 100%|███████████████████████████████████████████████████████████████████████████████████████| 1795/1795 [03:49<00:00,  7.82it/s, loss=3.34e-6]
📈 训练损失: 0.0873
🎯 验证准确率: 71.87%, 验证损失: 2.7899                                                                                                               
📉 学习率从 5.00e-06 降低到 2.50e-06
🛑 早停触发，训练结束
🏁 训练结束

==================================================
🎯 训练总结
==================================================
📊 最终准确率: 72.26%
💾 最佳模型: best_vit_base_local_pretrained.pth

==================================================
🔍 示例预测
==================================================

🎯 单图预测结果:
  图片: PrivateTest_3309033.jpg
  预测类别: sad
  置信度: 0.9673
